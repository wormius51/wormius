var canvas=document.getElementById("graph"),ctx=canvas.getContext("2d"),rotation=Math.round(360*Math.random()),SCALE_FACTOR=1;function GenerateGraph(t){ctx.fillStyle="white",ctx.fillRect(0,0,canvas.width,canvas.height);var e=0,a=0;for(i=0;i<t.length;i++)t[i].number<0&&(t[i].number=0),e+=t[i].number;for(i=0;i<t.length;i++){t[i].percent=t[i].number/e,t[i].angle=360*t[i].percent,DrawCircle(50*SCALE_FACTOR,a+rotation,t[i].angle+a+rotation,t[i].color),a+=t[i].angle;var n=t[i].name+" - "+t[i].number+"("+100*t[i].percent.toFixed(1)+"%)",c="italic "+Math.round(13*SCALE_FACTOR)+"px Arial";DrawText(canvas.width-4*n.length*SCALE_FACTOR,(18*i+20)*SCALE_FACTOR,n,c,t[i].color)}DrawText(75*SCALE_FACTOR,25*SCALE_FACTOR,"Statistics","italic "+Math.round(30*SCALE_FACTOR)+"px Arial","black")}function DrawCircle(t,e,a,i){ctx.save(),ctx.fillStyle=i,ctx.strokeStyle="#00000000";var n=canvas.width/2,c=canvas.height/2;ctx.beginPath(),ctx.arc(n,c,.75*c,Degrees2Radians(e),Degrees2Radians(a)),ctx.lineTo(n,c),ctx.stroke(),ctx.fill(),ctx.restore()}function DrawText(t,e,a,i,n){ctx.save(),ctx.fillStyle=n,ctx.font=i,ctx.textBaseline="middle",ctx.textAlign="center",ctx.fillText(a,t,e),ctx.strokeStyle="#000000",ctx.lineWidth=.4,ctx.strokeText(a,t,e),ctx.restore()}function Degrees2Radians(t){return t*Math.PI/180}function SetRotation(t){rotation=t}function CalculateScaleFactor(){SCALE_FACTOR=canvas.width/500}CalculateScaleFactor();
